import React, { useState, useEffect } from "react";
import ReactDOM from "react-dom";
import TeamMap from "./TeamMap";
import Consumer from "./Consumer";
// import getPlaces from "./utils/getPlaces";

import "./styles.css";

const places = [
  { title: "title", coords: { lat: 37.772, lng: -122.214 } },
  { title: "title", coords: { lat: -27.467, lng: 153.027 } }
];
const rootElement = document.getElementById("root");
// credit: https://publiuslogic.com/blog/google-maps+react-hooks/
const addMarkers = links => map => {
  links.forEach((link, index) => {
    const marker = new window.google.maps.Marker({
      map,
      position: link.coords,
      label: `${index + 1}`,
      title: link.title
    });
    marker.addListener(`click`, () => {
      console.log(link);
    });
  });
};

const addPolyline = (map, enabled) => {
  var flightPlanCoordinates = [
    { lat: 37.772, lng: -122.214 },
    { lat: 21.291, lng: -157.821 },
    { lat: -18.142, lng: 178.431 },
    { lat: -27.467, lng: 153.027 }
  ];
  var flightPath = new window.google.maps.Polyline({
    path: flightPlanCoordinates,
    geodesic: true,
    strokeColor: "#FF0000",
    strokeOpacity: 1.0,
    strokeWeight: 4
  });

  enabled ? flightPath.setMap(map) : flightPath.setMap(null);
};

const addOtherPolyline = map => {
  var flightPlanCoordinates = [
    { lat: 36.772, lng: -122.314 },
    { lat: 22.201, lng: -167.721 },
    { lat: -17.132, lng: 177.531 },
    { lat: -27.567, lng: 153.127 }
  ];

  var flightPath = new window.google.maps.Polyline({
    path: flightPlanCoordinates,
    geodesic: true,
    strokeColor: "#000000",
    strokeOpacity: 2.0,
    strokeWeight: 4
  });

  flightPath.setMap(map);
};

const App = () => {
  const [showLine, setShowLine] = useState(false);

  const mapProps = {
    // options: { center: { lat: 20, lng: 40 }, zoom: 4 },
    options: { center: { lat: 0, lng: -180 }, zoom: 3 },
    // onMount: addMarkers(places)
    onMount: map => {
      addPolyline(map, showLine);
      addOtherPolyline(map);
      addMarkers(places)(map);
    }
  };
  return (
    <div>
      <button onClick={v => setShowLine(!showLine)}>show</button>
      <TeamMap {...mapProps} />
    </div>
  );
};

const original = [
  "47.52857208251953,-121.87638854980469",
  "47.5285301,-121.8768357",
  "47.5280997,-121.8765309",
  "47.5259272,-121.8791675",
  "47.5251114,-121.8797643",
  "47.5245173,-121.8800495",
  "47.5234913,-121.8801715",
  "47.5221332,-121.8800442",
  "47.5188822,-121.8790724",
  "47.5179133,-121.8791596",
  "47.5168787,-121.8794234",
  "47.5152767,-121.8805482",
  "47.5131232,-121.8826206",
  "47.5121462,-121.883159",
  "47.5106848,-121.8832813",
  "47.5096602,-121.8835719",
  "47.5092866,-121.8847613",
  "47.5089526,-121.8855569",
  "47.5072157,-121.9007541",
  "47.5079792,-121.9041624",
  "47.5157819,-121.9180395",
  "47.5205535,-121.9294099",
  "47.5221796,-121.9348289",
  "47.5242796,-121.9371252",
  "47.5301939,-121.9418156",
  "47.5313502,-121.943811",
  "47.5321977,-121.9476812",
  "47.5331376,-121.9582626",
  "47.533986,-121.9623372",
  "47.5359081,-121.9677183",
  "47.5363482,-121.9695934",
  "47.536265,-121.9715743",
  "47.5351012,-121.9750563",
  "47.5329528,-121.9772868",
  "47.5313688,-121.9800934",
  "47.5311152,-121.984036",
  "47.5317028,-121.9921392",
  "47.5321055,-121.9947466",
  "47.5340706,-122.0009362",
  "47.5370806,-122.0082772",
  "47.5368645,-122.0123705",
  "47.5334696,-122.0186792",
  "47.5318726,-122.0225488",
  "47.5321873,-122.0265397",
  "47.5332783,-122.0289208",
  "47.5405943,-122.0358548",
  "47.5415905,-122.0375276",
  "47.5449245,-122.0451212",
  "47.5453561,-122.047321",
  "47.545595,-122.0516739",
  "47.5464721,-122.0557343",
  "47.5786375,-122.1333199",
  "47.5805441,-122.1754392",
  "47.5794231,-122.1896124",
  "47.5801391,-122.1954339",
  "47.5784714,-122.2025666",
  "47.578045,-122.2064672",
  "47.5794714,-122.2144965",
  "47.5801653,-122.2161447",
  "47.5818844,-122.2185808",
  "47.5882536,-122.2324804",
  "47.5893655,-122.2358124",
  "47.5908092,-122.3090788",
  "47.5912328,-122.3102109",
  "47.5919387,-122.310962",
  "47.5938064,-122.312262",
  "47.5950807,-122.3139563",
  "47.595107,-122.3166679",
  "47.5948444,-122.317731",
  "47.595187,-122.3194447",
  "47.5961723,-122.3198506",
  "47.5977307,-122.3200581",
  "47.5984067,-122.3205382",
  "47.6000832,-122.3221284",
  "47.6033836,-122.3263483",
  "47.6079537,-122.3303611",
  "47.610194,-122.3313092",
  "47.6114282,-122.3312873",
  "47.6176868,-122.3284413",
  "47.6279221,-122.3279082",
  "47.6299478,-122.3263455",
  "47.6318875,-122.3242646",
  "47.6348855,-122.3230168",
  "47.6813169,-122.3201665",
  "47.6818675,-122.3190909",
  "47.6815469,-122.3178223",
  "47.6815755,-122.3165205",
  "47.6814917,-122.3157679",
  "47.681489,-122.3154231",
  "47.6818596,-122.3153184",
  "47.6826474,-122.3153483",
  "47.6831735,-122.3158637",
  "47.6832153,-122.3199302",
  "47.6833287,-122.3203614",
  "47.6844372,-122.3202189",
  "47.6846864,-122.3203235",
  "47.6845718,-122.3211674",
  "47.6843585,-122.3208598"
];

const snapped = [
  "47.528777,-121.876882",
  "47.52857,-121.876722",
  "47.528148,-121.876394",
  "47.527982,-121.876277",
  "47.526961,-121.878021",
  "47.525922,-121.879157",
  "47.525091,-121.879675",
  "47.524505,-121.879961",
  "47.523491,-121.880179",
  "47.522134,-121.880032",
  "47.518884,-121.879024",
  "47.517903,-121.879067",
  "47.51687,-121.879374",
  "47.515282,-121.88056",
  "47.514889,-121.880786",
  "47.513098,-121.882541",
  "47.512383,-121.882871",
  "47.510678,-121.883204",
  "47.50971,-121.883449",
  "47.509716,-121.883566",
  "47.509694,-121.884107",
  "47.509396,-121.884717",
  "47.509169,-121.885622",
  "47.507571,-121.89529",
  "47.5072,-121.898326",
  "47.507132,-121.900761",
  "47.507325,-121.902271",
  "47.507595,-121.903339",
  "47.507978,-121.904163",
  "47.515699,-121.918128",
  "47.520537,-121.929425",
  "47.522251,-121.934721",
  "47.523319,-121.936155",
  "47.524332,-121.936986",
  "47.530226,-121.941769",
  "47.531486,-121.944311",
  "47.532097,-121.947703",
  "47.533122,-121.958267",
  "47.534078,-121.962271",
  "47.535879,-121.967737",
  "47.536203,-121.969614",
  "47.536125,-121.971536",
  "47.535567,-121.973644",
  "47.534933,-121.9748",
  "47.532901,-121.977187",
  "47.532178,-121.978269",
  "47.531462,-121.98015",
  "47.531151,-121.982285",
  "47.53119,-121.984028",
  "47.531485,-121.989745",
  "47.531756,-121.992123",
  "47.532221,-121.994692",
  "47.532978,-121.997733",
  "47.534121,-122.000892",
  "47.536459,-122.006165",
  "47.536977,-122.008307",
  "47.536771,-122.012322",
  "47.536423,-122.013471",
  "47.535983,-122.014423",
  "47.533436,-122.018634",
  "47.532403,-122.020659",
  "47.531928,-122.022568",
  "47.531846,-122.024523",
  "47.532194,-122.026536",
  "47.532659,-122.027792",
  "47.533555,-122.029196",
  "47.538805,-122.033888",
  "47.5405,-122.035991",
  "47.541462,-122.037663",
  "47.544142,-122.043276",
  "47.544805,-122.045181",
  "47.545199,-122.047361",
  "47.545597,-122.051674",
  "47.546537,-122.055679",
  "47.558758,-122.087042",
  "47.568882,-122.105617",
  "47.578568,-122.133349",
  "47.5803,-122.163829",
  "47.580515,-122.175436",
  "47.579462,-122.189605",
  "47.580132,-122.195433",
  "47.578457,-122.20256",
  "47.578176,-122.206447",
  "47.579515,-122.214465",
  "47.580238,-122.216058",
  "47.581919,-122.218532",
  "47.588809,-122.233148",
  "47.58993,-122.236556",
  "47.591717,-122.240699",
  "47.592219,-122.242705",
  "47.592331,-122.244293",
  "47.591936,-122.246876",
  "47.589975,-122.251387",
  "47.58962,-122.253842",
  "47.590411,-122.287066",
  "47.590586,-122.307624",
  "47.590796,-122.309088",
  "47.591265,-122.310169",
  "47.591937,-122.310968",
  "47.593792,-122.312305",
  "47.594416,-122.312931",
  "47.594914,-122.314069",
  "47.59513,-122.315134",
  "47.594998,-122.316623",
  "47.594791,-122.317711",
  "47.594817,-122.318486",
  "47.595272,-122.319256",
  "47.59618,-122.319764",
  "47.597715,-122.320164",
  "47.598405,-122.320545",
  "47.600086,-122.322122",
  "47.603395,-122.326326",
  "47.60797,-122.330317",
  "47.609002,-122.330885",
  "47.610183,-122.331008",
  "47.617689,-122.328459",
  "47.626588,-122.328141",
  "47.627903,-122.327816",
  "47.629909,-122.32628",
  "47.631907,-122.324326",
  "47.634888,-122.323032",
  "47.670485,-122.321703",
  "47.675619,-122.320514",
  "47.681306,-122.320129",
  "47.681705,-122.319112",
  "47.681559,-122.317822",
  "47.681553,-122.316521",
  "47.681548,-122.315765",
  "47.681713,-122.315325",
  "47.682646,-122.315312",
  "47.68305,-122.315285",
  "47.683056,-122.315867",
  "47.683098,-122.318979",
  "47.683148,-122.31994",
  "47.683167,-122.320195",
  "47.68333,-122.320197",
  "47.684437,-122.320207",
  "47.684596,-122.320209",
  "47.684597,-122.320326",
  "47.684605,-122.321166",
  "47.684608,-122.321552"
];

ReactDOM.render(<Consumer data={{ original, snapped }} />, rootElement);
